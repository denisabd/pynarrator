```python
import os
from pynarrator import narrate_descriptive, read_data, gpt_get_completions, enhance_narrative, translate_narrative, summarize_narrative
```


```python
df = read_data()
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order ID</th>
      <th>Date</th>
      <th>Region</th>
      <th>Product</th>
      <th>Store</th>
      <th>Promotion</th>
      <th>Price</th>
      <th>Quantity</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>QR10276</td>
      <td>2019-01-30</td>
      <td>EMEA</td>
      <td>Tools</td>
      <td>Big</td>
      <td>1</td>
      <td>89.6</td>
      <td>28</td>
      <td>2007.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>QR15245</td>
      <td>2020-07-26</td>
      <td>ASPAC</td>
      <td>Tools</td>
      <td>Big</td>
      <td>0</td>
      <td>268.5</td>
      <td>7</td>
      <td>1879.50</td>
    </tr>
    <tr>
      <th>2</th>
      <td>QR13938</td>
      <td>2020-03-05</td>
      <td>EMEA</td>
      <td>Home</td>
      <td>Big</td>
      <td>0</td>
      <td>223.3</td>
      <td>18</td>
      <td>4019.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>QR15934</td>
      <td>2020-10-08</td>
      <td>LATAM</td>
      <td>Clothing</td>
      <td>Big</td>
      <td>0</td>
      <td>210.4</td>
      <td>27</td>
      <td>5680.80</td>
    </tr>
    <tr>
      <th>4</th>
      <td>QR10963</td>
      <td>2019-04-15</td>
      <td>EMEA</td>
      <td>Tools</td>
      <td>Big</td>
      <td>0</td>
      <td>193.1</td>
      <td>22</td>
      <td>4248.20</td>
    </tr>
  </tbody>
</table>
</div>




```python
narrative = narrate_descriptive(df, measure = 'Sales', dimensions = ['Region', 'Product'])
print(narrative)
```

    {'Total Sales': 'Total Sales across all Regions is 38790478.42.'}



```python
n = str(narrative)
f'{narrative}'
```




    "{'Total Sales': 'Total Sales across all Regions is 38790478.42.'}"




```python
enhance_narrative("Total Spend went up by 2354, from 1000 to 3354")
```

    Improve the narrative by adding better business language for the following: "Total Spend went up by 2354, from 1000 to 3354"





    'The overall expenditure has escalated by 2354 units, signaling a substantial increase from the initial sum of 1000 units to a revised estimate of 3354 units.'




```python
enhance_narrative(narrative)

```

    Improve the narrative by adding better business language for the following: "{'Total Sales': 'Total Sales across all Regions is 38790478.42.'}"





    '"The aggregate revenue generated by all business units across different geographic regions is 38790478.42, constituting the Total Sales figure. This metric represents the entire sum of income earned by the organization and is a key indicator of its financial performance."'




```python
prompt = "Improve the narrative by adding better business language for 'By Region Sales across all Regions is 2.3 M. Outlying Regions by Sales: West (725,457.9, 31.6 %), East (678,781.2, 29.5 %) West by Segment. In West, Sales across all Segment is equal to 725,457.9. In West, significant Segment by Sales: Consumer (362,880.8, 50.0 %) East by Segment. In East, Sales across all Segment is equal to 678,781.2. In East, significant Segment by Sales: Consumer (350,908.2, 51.7 %). By Segment. Sales across all Segment is 2.3 M. Outlying Segment by Sales: Consumer (1.2 M, 50.6 %)'"

output = gpt_get_completions(prompt)
print(output)
```

    The current report details the sales performance of the business across different regions and segments. The overall sales across all regions amount to 2.3 million. The outlying regions have contributed significantly to the sales figures, with the West region raking in 725,457.9 or 31.6% of the total sales, followed by the East region with 678,781.2, making up for 29.5% of the total sales.
    
    Upon further scrutiny, it is observed that the West region's crucial segment by sales is the Consumer segment, accounting for 50.0% or 362,880.8 in sales. Similarly, in the East region, the Consumer segment has emerged as the significant contributor to sales, making up 51.7% or 350,908.2 in sales. 
    
    A closer examination of sales across all segments indicates that the Consumer segment remains the most significant contributor, with sales across all segments totaling 2.3 million. The Consumer segment alone has brought in 1.2 million in sales, accounting for 50.6% of the total sales figures.



```python
translate_narrative(output, language="Russian")
```

    Using professional language translate the following text to Russian: "The current report details the sales performance of the business across different regions and segments. The overall sales across all regions amount to 2.3 million. The outlying regions have contributed significantly to the sales figures, with the West region raking in 725,457.9 or 31.6% of the total sales, followed by the East region with 678,781.2, making up for 29.5% of the total sales.
    
    Upon further scrutiny, it is observed that the West region's crucial segment by sales is the Consumer segment, accounting for 50.0% or 362,880.8 in sales. Similarly, in the East region, the Consumer segment has emerged as the significant contributor to sales, making up 51.7% or 350,908.2 in sales. 
    
    A closer examination of sales across all segments indicates that the Consumer segment remains the most significant contributor, with sales across all segments totaling 2.3 million. The Consumer segment alone has brought in 1.2 million in sales, accounting for 50.6% of the total sales figures."





    'Данный отчет подробно описывает продажи бизнеса по различным регионам и сегментам. Общий объем продаж по всем регионам составляет 2,3 миллиона. Отдельные выделенные регионы внесли значительный вклад в продажи: Западный регион приносит 725 457,9 или 31,6% от общих продаж, за ним следует Восточный регион с 678 781,2, что составляет 29,5% от общих продаж.\n\nДальнейший анализ показал, что в Западном регионе Consumer-сегмент имеет первостепенное значение в продажах, которые составили 50,0% или 362 880,8. Аналогично, в Восточном регионе, Consumer-сегмент представляет собой значительный вклад в продажи, составляя 51,7% или 350 908,2.\n\nПри более тщательном изучении продаж во всех сегментах видно, что Consumer-сегмент остается наиболее значимым, с общим объемом продаж в 2,3 миллиона. Consumer-сегмент по отдельности принес более 1,2 миллиона продаж, что составляет 50,6% от общей суммы продаж.'




```python
summarize_narrative(output)
```

    Summarize the following narrative to make it shorter: "The current report details the sales performance of the business across different regions and segments. The overall sales across all regions amount to 2.3 million. The outlying regions have contributed significantly to the sales figures, with the West region raking in 725,457.9 or 31.6% of the total sales, followed by the East region with 678,781.2, making up for 29.5% of the total sales.
    
    Upon further scrutiny, it is observed that the West region's crucial segment by sales is the Consumer segment, accounting for 50.0% or 362,880.8 in sales. Similarly, in the East region, the Consumer segment has emerged as the significant contributor to sales, making up 51.7% or 350,908.2 in sales. 
    
    A closer examination of sales across all segments indicates that the Consumer segment remains the most significant contributor, with sales across all segments totaling 2.3 million. The Consumer segment alone has brought in 1.2 million in sales, accounting for 50.6% of the total sales figures."





    'This report shows sales performance by region and segment, with overall sales at 2.3 million. The West region had the highest sales at 725,457.9, followed by the East at 678,781.2. The Consumer segment was the most significant contributor to sales, accounting for 50.6% or 1.2 million in sales.'


